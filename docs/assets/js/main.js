"use strict";let seriesAnime=[],favouriteSeriesAnime=JSON.parse(localStorage.getItem("favourites"))||[];const apiUrl="https://api.jikan.moe/v3/search/anime",listSeries=document.querySelector(".js-list-series"),listSeriesFavourite=document.querySelector(".js-list-series-favourite"),inputSearch=document.querySelector(".js-search_series"),btnSearch=document.querySelector(".js-btn-search"),btnReset=document.querySelector(".js-btn-reset-search"),btnResetFav=document.querySelector(".js-favourites__btn-reset");function getHtmlSerie(e){const i=e.image_url||"https://via.placeholder.com/210x295/ffffff/666666/?text=TV";let t=`<li class="serie js-selectorSeriesFavourites" data-id="${e.mal_id}">`;return t+=`  <h2 class="serie__title">${e.title}</h2>`,t+=`  <img class="serie__img js-img-series" src="${i}"`,t+='    alt="no existe imagen">',t+="</li>",t}function getHtmlSerieFavourite(e){const i=e.image_url||"https://via.placeholder.com/210x295/ffffff/666666/?text=TV";let t='<li class="serie-favourite">';return t+=`  <h2 class="serie-favourite__title">${e.title} <span class="delete-fav js-deleteFav" data-id="${e.mal_id}">x</span></h2>`,t+=`  <img class="serie-favourite__img js-img-series" src="${i}"`,t+='    alt="no existe imagen">',t+="</li>",t}function paintListSeries(){if(listSeries.innerHTML="",seriesAnime)for(let e=0;e<seriesAnime.length;e++){const i=seriesAnime[e];listSeries.innerHTML+=getHtmlSerie(i)}else listSeries.innerHTML="Serie no encontrada, prueba con otra";listenAddSerie()}function paintListFavouriteSeries(){listSeriesFavourite.innerHTML="";for(let e=0;e<favouriteSeriesAnime.length;e++){const i=favouriteSeriesAnime[e];listSeriesFavourite.innerHTML+=getHtmlSerieFavourite(i)}listenRemoveFavourite()}function listenAddSerie(){const e=document.querySelectorAll(".js-selectorSeriesFavourites");for(let i=0;i<e.length;i++){e[i].addEventListener("click",addSeriesFavourite)}}function listenRemoveFavourite(){const e=document.querySelectorAll(".js-deleteFav");for(let i=0;i<e.length;i++){e[i].addEventListener("click",removeSeriesFavourites)}}function addSeriesFavourite(e){const i=parseInt(e.currentTarget.dataset.id),t=seriesAnime.find(e=>e.mal_id===i),r=favouriteSeriesAnime.find(e=>e.mal_id===i);e.currentTarget.classList.add("now-favourite"),void 0===r&&favouriteSeriesAnime.push({title:t.title,mal_id:t.mal_id,image_url:t.image_url}),localStorage.setItem("favourites",JSON.stringify(favouriteSeriesAnime)),paintListFavouriteSeries()}function removeSeriesFavourites(e){const i=parseInt(e.currentTarget.dataset.id),t=favouriteSeriesAnime.findIndex(e=>e.mal_id===i);t>=0&&favouriteSeriesAnime.splice(t,1),localStorage.setItem("favourites",JSON.stringify(favouriteSeriesAnime)),paintListFavouriteSeries()}function searchSeries(e){e.preventDefault();const i=inputSearch.value;fetch(`${apiUrl}?q=${i}`).then(e=>e.json()).then(e=>{seriesAnime=e.results,paintListSeries()})}function handleClickReset(){seriesAnime=[],inputSearch.value="",paintListSeries()}function handleClickResetFav(){favouriteSeriesAnime=[],localStorage.setItem("favourites",JSON.stringify(favouriteSeriesAnime)),paintListFavouriteSeries()}btnSearch.addEventListener("click",searchSeries),btnReset.addEventListener("click",handleClickReset),btnResetFav.addEventListener("click",handleClickResetFav),paintListFavouriteSeries();